dependencies {
    liquibaseRuntime 'org.liquibase:liquibase-core:4.22.0'
    //liquibaseRuntime 'com.h2database:h2:2.1.214'
    liquibaseRuntime sourceSets.main.allSource
    liquibaseRuntime sourceSets.main.compileClasspath
    liquibaseRuntime sourceSets.main.runtimeClasspath
    liquibaseRuntime sourceSets.main.output
}

liquibaseDiff.dependsOn compileJava
liquibaseDiffChangeLog.dependsOn compileJava
liquibaseGenerateChangelog.dependsOn compileJava
def ts= new Date().format("yyyyMMdd-HHmmss")

liquibase {
    activities {
        main {
            changeLogFile "src/main/resources/db/changelog/changes/${ts}.yaml"
            url 'jdbc:h2:file:./.data/diff'
            //url 'jdbc:h2:mem:testdb'
            username 'sa'
            password ''
            //referenceDriver 'org.h2.Driver'
            referenceDriver 'liquibase.ext.hibernate.database.connection.HibernateDriver'
            referenceUrl 'hibernate:spring:com.net128.oss.web.lib.jpa.csv.data.test?dialect=org.hibernate.dialect.H2Dialect'
//            referenceUsername 'sa'
//            referencePassword ''
        }

        //runList =  project.ext.runList
    }
}
